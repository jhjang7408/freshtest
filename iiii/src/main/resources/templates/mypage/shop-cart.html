<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
  <head>
    <title>FreshCart - eCommerce HTML Template</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta content="Codescandy" name="author" />

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-M8S4MT3EYG"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-M8S4MT3EYG");
    </script>

    <!-- Favicon icon-->
    <link
            rel="shortcut icon"
            type="image/x-icon"
            th:href="@{/images/favicon/favicon.ico}"
    />

    <!-- Libs CSS -->
    <link
            th:href="@{/libs/bootstrap-icons/font/bootstrap-icons.css}"
            rel="stylesheet"
    />
    <link
            th:href="@{/libs/feather-webfont/dist/feather-icons.css}"
            rel="stylesheet"
    />
    <link
            th:href="@{/libs/simplebar/dist/simplebar.min.css}"
            rel="stylesheet"
    />

    <!-- Theme CSS -->
    <link rel="stylesheet" th:href="@{/css/theme.min.css}" />
  </head>

  <body>
  <div class="border-bottom">
    <div class="py-4 pt-lg-3 pb-lg-0">
      <div class="container">
        <div class="row w-100 align-items-center gx-lg-2 gx-0">
          <div class="col-xxl-2 col-lg-3">
            <a class="navbar-brand d-none d-lg-block" href="/">
              <img th:src="@{/images/수신호멈.jpg}"
                   alt="eCommerce HTML Template"/>
            </a>
            <div class="d-flex justify-content-between w-100 d-lg-none">
              <a class="navbar-brand" href="/">
                <img
                        th:src="@{/images/logo/freshcart-logo.svg}"
                        alt="eCommerce HTML Template"
                />
              </a>

              <div class="d-flex align-items-center lh-1">
                <div class="list-inline me-4">
                  <div class="list-inline-item">
                    <a
                            href="#!"
                            class="text-muted"
                            data-bs-toggle="modal"
                            data-bs-target="#userModal"
                    >
                      <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="20"
                              height="20"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="feather feather-user"
                      >
                        <path
                                d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
                        ></path>
                        <circle cx="12" cy="7" r="4"></circle>
                      </svg>
                    </a>
                  </div>
                  <div class="list-inline-item">
                    <a
                            class="text-muted position-relative"
                            data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasRight"
                            href="#offcanvasExample"
                            role="button"
                            aria-controls="offcanvasRight"
                    >
                      <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="20"
                              height="20"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="feather feather-shopping-bag"
                      >
                        <path
                                d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"
                        ></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                      </svg>
                      <span
                              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success"
                      >
                          1
                          <span class="visually-hidden">unread messages</span>
                        </span>
                    </a>
                  </div>
                </div>
                <!-- Button -->
                <button
                        class="navbar-toggler collapsed"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#navbar-default"
                        aria-controls="navbar-default"
                        aria-expanded="false"
                        aria-label="Toggle navigation"
                >
                  <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="32"
                          height="32"
                          fill="currentColor"
                          class="bi bi-text-indent-left text-primary"
                          viewBox="0 0 16 16"
                  >
                    <path
                            d="M2 3.5a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5zm.646 2.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L4.293 8 2.646 6.354a.5.5 0 0 1 0-.708zM7 6.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 3a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="col-xxl-6 col-lg-5 d-none d-lg-block">
            <form action="#">
              <div class="input-group">
                <input
                        class="form-control rounded"
                        type="search"
                        placeholder="Search for products"
                />
                <span class="input-group-append">
                    <button
                            class="btn bg-white border border-start-0 ms-n10 rounded-0 rounded-end"
                            type="button"
                    >
                      <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="feather feather-search"
                      >
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                      </svg>
                    </button>
                  </span>
              </div>
            </form>
          </div>

          <!-- Button trigger modal -->
          <!-- <button type="button" class="btn  btn-outline-gray-400 text-muted" data-bs-toggle="modal" -->
          <!-- data-bs-target="#locationModal"> -->
          <!-- <i class="feather-icon icon-map-pin me-2"></i>Location 옆 로그인210줄 -->
          <!-- </button> -->
          <!-- </div>  -->

          <div class="col-md-4 col-xxl-4 text-end d-none d-lg-block">
            <div class="list-inline">
              <div class="list-inline-item" sec:authorize="!isAuthenticated()">
                <a href="/member/signin">로그인</a>
              </div>
              <div class="list-inline-item" sec:authorize="isAuthenticated()">
                <a href="/member/logout">로그아웃</a>
              </div>
              <!--            th:if="${session.loginId != null}"-->
              <div class="list-inline-item" sec:authorize="isAuthenticated()">
                <li class="nav-item dropdown" >
                  <a
                          class="nav-link dropdown-toggle"
                          href="#"
                          role="button"
                          data-bs-toggle="dropdown"
                          aria-expanded="false"
                  >
                    마이페이지
                  </a>
                  <ul class="dropdown-menu">
                    <li>
                      <a class="dropdown-item" href="/mypage/shop-cart"
                      >장바구니</a
                      >
                    </li>
                    <li>
                      <a
                              class="dropdown-item"
                              href="/mypage/orderlist-bike"
                      >자전거 구매내역</a
                      >
                    </li>
                    <li>
                      <a
                              class="dropdown-item"
                              href="/mypage/orderlist-acc"
                      >악세사리 구매내역</a
                      >
                    </li>
                    <li>
                      <a
                              class="dropdown-item"
                              href="/mypage/listsell"
                      >판매 목록</a
                      >
                    </li>
                    <li>
                      <a
                              class="dropdown-item"
                              href="/mypage/account-modify"
                      >개인정보 수정</a
                      >
                    </li>
                  </ul>
                </li>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <nav
            class="navbar navbar-expand-lg navbar-light navbar-default py-0 py-lg-4"
    >
      <div class="container px-0 px-md-3">
        <div class="offcanvas offcanvas-start p-4 p-lg-0" id="navbar-default">
          <div
                  class="d-flex justify-content-between align-items-center mb-2 d-block d-lg-none"
          >
            <a href="/"
            ><img
                    th:src="@{../images/logo/freshcart-logo.svg}"
                    alt="eCommerce HTML Template"
            /></a>
            <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"
            ></button>
          </div>
          <div class="d-block d-lg-none my-4">
            <form action="#">
              <div class="input-group">
                <input
                        class="form-control rounded"
                        type="search"
                        placeholder="Search for products"
                />
                <span class="input-group-append">
                    <button
                            class="btn bg-white border border-start-0 ms-n10 rounded-0 rounded-end"
                            type="button"
                    >
                      <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              viewBox="0 0 24 24"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="2"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              class="feather feather-search"
                      >
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                      </svg>
                    </button>
                  </span>
              </div>
            </form>
            <div class="mt-2">
              <button
                      type="button"
                      class="btn btn-outline-gray-400 text-muted w-100"
                      data-bs-toggle="modal"
                      data-bs-target="#locationModal"
              >
                <i class="feather-icon icon-map-pin me-2"></i>Pick Location
              </button>
            </div>
          </div>

          <div class="d-none d-lg-block">
            <ul class="navbar-nav align-items-center">
              <li class="nav-item dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                >
                  판매 등록
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="/acc/productRegister" sec:authorize="hasRole('ROLE_ADMIN')">악세서리 판매 등록</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/bike/productRegister" sec:authorize="!isAuthenticated() or hasRole('ROLE_USER') or hasRole('ROLE_ADMIN')">자전거 판매 등록</a>
                  </li>
                </ul>
              </li>

              <li class="nav-item dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                >
                  구매
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="/acc/accList"
                    >악세서리 구매</a
                    >
                  </li>
                  <li>
                    <a
                            class="dropdown-item"
                            href="/bike/bikeList"
                    >자전거 구매</a
                    >
                  </li>
                  <li>
                    <a class="dropdown-item" href="/mypage/shop-cart"
                       sec:authorize="isAuthenticated()">장바구니</a>
                  </li>
                </ul>
              </li>
              <li class="nav-item dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                >
                  커뮤니티
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="/qa/guide"
                    >가이드</a
                    >
                  </li>
                  <li>
                    <a class="dropdown-item" href="/qa/qalist"
                    >질문/정보 게시판</a
                    >
                  </li>
                </ul>
              </li>

              <li class="nav-item dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                >
                  공지
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="../pages/signin.html"
                    >공지</a
                    >
                  </li>
                  <li>
                    <a class="dropdown-item" href="../pages/signup.html"
                    >이벤트</a
                    >
                  </li>
                </ul>
              </li>

              <li class="nav-item dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                >
                  고객센터
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="/member/signin" sec:authorize="!isAuthenticated()">1:1문의</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/moon/qamoonlist" sec:authorize="isAuthenticated()">1:1문의</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/moon/moonlist">자주 묻는 질문</a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>
  </div>

    <main>
      <section class="mb-lg-14 mb-8 mt-8">
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-md-7">
              <div class="py-3">

                <!-- 장바구니 제품 페이지 -->
                <ul class="list-group list-group-flush" >
                  <li class="list-group-item py-3 py-lg-0 px-0 border-top"/>
                  <li class="list-group-item py-3 py-lg-0 px-0" th:each="cart : ${cart}">
                    <div class="row align-items-center">
                      <!-- 이미지 파일-->
                      <div class="col-3 col-md-2">
                        <img th:src="@{'/uploadImg/' + ${cart.image}}" alt="Ecommerce" class="img-fluid"/>
                      </div>
                      <div class="col-4 col-md-5">

                        <!-- 상품명 -->
                        <h5 class="mb-0">  <a th:href="@{/acc/productSingle/{acid}(acid=${cart.acid})}" class="text-inherit" th:text="${cart.pName}"></a>
                          </h5>

                        <!-- 삭제버튼 링크 -->
                        <div class="mt-2 small lh-1">
                          <button type="button" class="remove-cart-btn text-decoration-none text-inherit" th:data-bagid="${cart.bagid}">
                            <span class="me-1 align-text-bottom">
                              <svg xmlns="http://www.w3.org/2000/svg"
                                   width="14"
                                   height="14"
                                   viewBox="0 0 24 24"
                                   fill="none"
                                   stroke="currentColor"
                                   stroke-width="2"
                                   stroke-linecap="round"
                                   stroke-linejoin="round"
                                   class="feather feather-trash-2 text-success"
                              >
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line></svg></span>
                            <span class="text-muted">삭제</span>
                          </button>
                        </div>
                      </div>

                      <!-- 장바구니 수량 + - 버튼 -->
                      <div class="col-3 col-md-3 col-lg-2">
                        <div class="input-group input-spinner">
                          <input type="button" value="-" class="button-minus btn btn-sm" data-field="quantity"/>
                          <input type="number" step="1" max="10" th:value="${cart.count}"  name="quantity" class="quantity-field form-control-sm form-input"/>
                          <input type="button" value="+" class="button-plus btn btn-sm" data-field="quantity"/>
                        </div>
                      </div>

                      <div class="col-2 text-lg-end text-start text-md-end col-md-2">
                        <span class="fw-bold text-danger" th:text="'&#8361; ' + ${cart.price}"></span>
                      </div>

                    </div>
                  </li>
                  <li class="list-group-item py-3 py-lg-0 px-0 border-bottom">
                  </li>
                </ul>
              </div>
            </div>

            <div class="col-12 col-lg-4 col-md-5">
              <div class="mb-5 card mt-6">
                <div class="card-body p-6">
                  <h2 class="h5 mb-4">결제하기</h2>
                  <div class="card mb-2">
                    <ul class="list-group list-group-flush">
                      <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="me-auto">
                          <div>총 주문 금액</div>
                        </div>
                        <span th:text="'&#8361; ' + ${totalSum}" ></span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="me-auto">
                          <div>예상 배송비</div>
                        </div>
                        <span>&#8361; 3000</span>
                      </li>
                      <li class="list-group-item d-flex justify-content-between align-items-start">
                        <div class="me-auto">
                          <div class="fw-bold">총 결제 금액</div>
                        </div>
                        <span class="fw-bold" th:text="'&#8361; ' + ${totalSum + 3000}"></span>
                      </li>
                    </ul>
                  </div>
                  <div class="d-grid mb-1 mt-4">
                    <!-- btn -->
                    <button class="btn btn-primary btn-lg d-flex justify-content-center align-items-center" type="submit">
                     <span class="fw-bold">결제하기</span>
                    </button>
                  </div>
                  <!-- heading -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container">
        <div class="row g-4 py-4">
          <div class="col-12 col-md-12 col-lg-8">
            <div class="row g-4">
              <div class="col-6 col-sm-6 col-md-2">
                <h6 class="mb-4">판매 등록</h6>
                <!-- list -->
                <ul class="nav flex-column">
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">판매 등록</a>
                  </li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-2">
                <h6 class="mb-4">구매</h6>
                <!-- list -->
                <ul class="nav flex-column">
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">악세서리 구매</a>
                  </li>
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">자전거 구매</a>
                  </li>
                  <li class="nav-item mb-2">
                    <a href="#1" class="nav-link">장바구니</a>
                  </li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-2">
                <h6 class="mb-4">커뮤니티</h6>
                <ul class="nav flex-column">
                  <!-- list -->
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">가이드</a>
                  </li>
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">질문/정보 게시판</a>
                  </li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-2">
                <h6 class="mb-4">공지</h6>
                <ul class="nav flex-column">
                  <!-- list -->
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">공지</a>
                  </li>
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">이벤트</a>
                  </li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-3">
                <h6 class="mb-4">고객센터</h6>
                <ul class="nav flex-column">
                  <!-- list -->
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">1:1문의</a>
                  </li>
                  <li class="nav-item mb-2">
                    <a href="#!" class="nav-link">자주 묻는 질문</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- Javascript-->
  <!-- Libs JS -->
    <script th:src="@{/libs/jquery/dist/jquery.min.js}"></script>
    <script th:src="@{/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/libs/simplebar/dist/simplebar.min.js}"></script>

      <!-- Theme JS -->
    <script th:src="@{/js/theme.min.js}"></script>
    <script th:src="@{/js/vendors/increment-value.js}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <script>
    $(document).ready(function() {
      $('.remove-cart-btn').click(function (e) {
        e.preventDefault();
        const bagid = $(this).data('bagid');
        const button = $(this);
        console.log(bagid);

        $.ajax({
          type : 'POST',
          url : '/mypage/removeCart',
          data : { 'bagid' : bagid},
          success: function (){
            alert('상품이 삭제되었습니다.');
            button.closest('li').remove();
          },
          error: function (){
            alert('오류가 발생했습니다.');
          }
        });
      });
    });


  </script>

<!--    <script th:inline="javascript">-->
<!--      /*<![CDATA[*/-->
<!--      const minusButtons = document.querySelectorAll(".button-minus");-->
<!--      const plusButtons = document.querySelectorAll(".button-plus");-->
<!--      minusButtons.forEach((button, index) => {-->
<!--      button.addEventListener("click", function() {-->
<!--        updateQuantityAndPrice(index, -1);-->
<!--      });-->
<!--    });-->

<!--      plusButtons.forEach((button, index) => {-->
<!--      button.addEventListener("click", function() {-->
<!--        updateQuantityAndPrice(index, 1);-->
<!--      });-->
<!--    });-->

<!--      function updateQuantityAndPrice(index, change) {-->
<!--        const quantityInput = document.querySelector("#quantity_" + index);-->
<!--        let quantity = parseInt(quantityInput.value);-->
<!--        if ((change == -1 && quantity > 1) || (change == 1 && quantity < 10)) {-->
<!--          quantity += change;-->
<!--          quantityInput.value = quantity;-->
<!--          let cartId = quantityInput.getAttribute('data-cartid');-->
<!--          const priceDisplay = document.querySelector("#price_" + cartId);-->
<!--          let totalPrice = parseFloat(priceDisplay.textContent.replace('$', ''));-->
<!--          let pricePerItem = totalPrice / (quantity - change);-->
<!--          totalPrice = quantity * pricePerItem;-->
<!--          priceDisplay.textContent = "$" + totalPrice.toFixed(2);-->
<!--          fetch('/mypage/update-cart', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--              'Content-Type': 'application/json',-->
<!--            },-->
<!--            body: JSON.stringify({cartId: cartId, quantity: quantity}),-->
<!--          });-->
<!--        }-->
<!--      }-->

<!--      /*]]>*/-->
<!--  </script>-->

  </body>
</html>
